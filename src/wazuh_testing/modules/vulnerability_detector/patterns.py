# Copyright (C) 2015-2023, Wazuh Inc.
# Created by Wazuh, Inc. <info@wazuh.com>.
# This program is free software; you can redistribute it and/or modify it under the terms of GPLv2
from wazuh_testing.modules.vulnerability_detector import VULNERABILITY_DETECTOR_PREFIX


# CPE Helper Callback patterns
CB_CPE_HELPER_INVALID_TAG_FAIL = ".*The 'Wazuh CPE Helper' update has failed, so the NVD feed will not be updated."
CB_CPE_INVALID_TAG = r".*WARNING:.*Invalid tag found when parsing the CPE dictionary: '{field}'"
CB_CPE_PACKAGE_INDEXED = r".*The CPE.*a:{package_vendor}:{package_name}.* from the agent '{agent_id}' was indexed"
CB_CPE_SYSTEM_INDEXED = r".*The CPE.*o:.*{index_system_name}.* from the agent '{agent_id}' was indexed"
CB_CPE_INVALID_FORMAT_VERSION = r".*ERROR:.*Invalid format version for the CPE helper: .*"
CB_ERROR_INSERTING_PACKAGE = r".*ERROR:.*Could not insert the CPEs from the agent '{agent_id}' into the database."
CB_CANNOT_INSERT_CPE_FROM_AGENT = r".*ERROR:.*Could not insert the CPEs from the agent '{agent_id}' into the database."
CB_CVE_AFFECTS_PACKAGE = r'.*"agent":."id":"{agent_id}".*{cve} affects {package}'
CB_COULD_NOT_GET_VERSION_CPE = r".*DEBUG:.*Couldn't get the version of the CPE for the {package_name} package."

# Feed related patterns
CB_DATABASE_UPDATE_STARTING = r".*Starting '{provider_name}' database update"
CB_FEED_UPDATE_FINISHED = r".*The update of the '{provider_name}' feed finished successfully."
CB_DATABASE_UPDATE_FAILED = r".*Failed when updating '{provider_feed_name}' database"
CB_CVE_DATABASE_UPDATE_ERROR = ".*ERROR:.*CVE database could not be updated."

# Configuration related patterns
CB_VDT_MODULE_DISABLED = f'{VULNERABILITY_DETECTOR_PREFIX}DEBUG: Module disabled. Exiting...'
CB_SCAN_INTERVAL_SLEEP = r".*wm_vuldet_run_sleep.*Sleeping for {interval} seconds..."


# Error Message patterns
ERR_MSG_PACKAGE_NOT_INDEXED = f"Did not receive the expected '{CB_CPE_PACKAGE_INDEXED}' event"
ERR_MSG_SYSTEM_NOT_INDEXED = f"Did not receive the expected '{CB_CPE_SYSTEM_INDEXED}' event"