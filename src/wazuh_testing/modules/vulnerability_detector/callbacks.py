# Copyright (C) 2015-2023, Wazuh Inc.
# Created by Wazuh, Inc. <info@wazuh.com>.
# This program is free software; you can redistribute it and/or modify it under the terms of GPLv2

from wazuh_testing.utils.callbacks import generate_callback


CB_CPE_HELPER_INVALID_TAG_FAIL = ".*The \'Wazuh CPE Helper\' update has failed, so the NVD feed will not be updated."

def check_cpe_helper_invalid_tag_warning(field=''):
    """Check that a warning message comes out for invalid tags.

    Args:
        field (str): Tag name
    """
    return generate_callback(fr".*WARNING:.*Invalid tag found when parsing the CPE dictionary: '{field}'")
    

def check_cpe_helper_packages_indexed(package_name='', package_vendor='wazuh-mocking', agent_id='000'):
    """Check in the log that a CPE helper package data was indexed.

    Args:
        package_name (str): Package name.
        package_vendor (str): Package vendor.
        agent_id (str): Agent ID.
    """
    return generate_callback(rf".*The CPE .*a:{package_vendor}:{package_name}.* from the agent '{agent_id}' was indexed")
