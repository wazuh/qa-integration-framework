# Copyright (C) 2015-2023, Wazuh Inc.
# Created by Wazuh, Inc. <info@wazuh.com>.
# This program is free software; you can redistribute it and/or modify it under the terms of GPLv2

from wazuh_testing.constants.variables import T_20


def check_cpe_helper_invalid_tag_warning(field='', log_monitor=None, timeout=T_20):
    """Check that a warning message comes out for invalid tags.

    Args:
        field (str): Tag name
        log_monitor (FileMonitor): Log monitor.
        timeout (str): timeout to check the event in Wazuh log.
    """
    return log_monitor(timeout=timeout, 
                       callback=f"WARNING: .* Invalid tag found when parsing the CPE dictionary: '{field}'")


def check_cpe_helper_packages_indexed(package_name='', package_vendor='wazuh-mocking', log_monitor=None,
                                      agent_id='000', timeout=T_20):
    """Check in the log that a CPE helper package data was indexed.

    Args:
        package_name (str): Package name.
        package_vendor (str): Package vendor.
        log_monitor (FileMonitor): Log monitor.
        agent_id (str): Agent ID.
        timeout (str): timeout to check the event in Wazuh log.
    """
    return log_monitor(timeout=timeout,
                       callback=rf"The CPE .*a:{package_vendor}:{package_name}.* from the agent '{agent_id}'"
                                  'was indexed')
